"use strict";const menuBurgerButton=document.querySelector(".main-header__menu"),headerNavigation=document.querySelector(".main-header__navigation");menuBurgerButton.addEventListener("click",e=>{e.preventDefault(),headerNavigation.classList.toggle("hidden")});const anchor=document.querySelector(".anchor"),floatingBasketButton=document.querySelector(".aerostat"),showAnchor=()=>{window.pageYOffset>document.documentElement.clientHeight?anchor.classList.add("anchor-show"):anchor.classList.remove("anchor-show")};let coords;const go=()=>{anchor.classList.contains("anchor-downward")?(window.scrollTo({top:coords,behavior:"smooth"}),anchor.classList.remove("anchor-downward")):(coords=window.pageYOffset,window.scrollTo({top:0,behavior:"smooth"}),anchor.classList.add("anchor-downward"),window.removeEventListener("scroll",showAnchor))};window.addEventListener("scroll",showAnchor),anchor.addEventListener("click",go);const carousel=document.querySelector(".solutions__slider"),tape=carousel.querySelector(".solutions__slider-list"),slides=carousel.querySelectorAll(".solutions__slider-item"),arrowLeft=carousel.querySelector(".solutions__slider-btn--prev"),arrowRight=carousel.querySelector(".solutions__slider-btn--next"),sliderSwitcher=document.querySelectorAll(".solutions__slider-radio-group input"),slideWidth=960;let position=0;const startPosition=0,endPosition=-slideWidth*(slides.length-1);sliderSwitcher.forEach((e,t)=>e.addEventListener("click",()=>{position=-slideWidth*t,tape.style.marginLeft=position+"px"}));const setSwitcherIndicator=()=>{sliderSwitcher.forEach(e=>{e.checked="false",sliderSwitcher[Math.abs(position/slideWidth)].checked="true"})},shiftRight=()=>{position-=slideWidth,position<endPosition&&(position=0),position=Math.max(position,endPosition),tape.style.marginLeft=position+"px",setSwitcherIndicator()},shiftLeft=()=>{position+=slideWidth,position>startPosition&&(position=endPosition),position=Math.min(position,startPosition),tape.style.marginLeft=position+"px",setSwitcherIndicator()};arrowRight.onclick=shiftRight,arrowLeft.onclick=shiftLeft,setInterval(shiftRight,5e3);var supportsVideo=!!document.createElement("video").canPlayType;if(supportsVideo){const e=document.querySelector(".video-module"),f=e.querySelector(".video-module__display"),g=e.querySelector(".video-module__controls");f.controls=!1,g.style.display="grid";const h=g.querySelector(".v-controls__timeline-full"),i=g.querySelector(".v-controls__timeline-filled"),j=g.querySelector(".v-controls__current-time"),k=g.querySelector(".v-controls__full-time"),l=e=>{let t=Math.trunc(e/60);t<10&&(t=`0${t}`);let o=Math.trunc(e%60);return o<10&&(o=`0${o}`),`${t}:${o}`};f.addEventListener("loadedmetadata",()=>{h.setAttribute("max",f.duration),j.textContent="00:00",k.textContent=l(f.duration)}),f.addEventListener("timeupdate",()=>{h.getAttribute("max")||h.setAttribute("max",f.duration),h.value=f.currentTime,i.style.width=Math.floor(f.currentTime/f.duration*100)+"%",j.textContent=l(f.currentTime),f.ended}),h.addEventListener("click",function(e){f.currentTime=e.offsetX/this.offsetWidth*f.duration});const m=g.querySelector(".v-controls__play-pause"),n=()=>{f.paused||f.ended?f.play():f.pause()};m.addEventListener("click",n),f.addEventListener("click",n),g.querySelector(".v-controls__stop").addEventListener("click",()=>{f.pause(),f.currentTime=0,h.value=0}),g.querySelector(".v-controls__rewind-right").addEventListener("click",()=>f.currentTime+=5),g.querySelector(".v-controls__rewind-left").addEventListener("click",()=>f.currentTime-=5);const o=g.querySelector(".v-controls__mute"),p=g.querySelector(".v-controls__sound-indicator"),q=e=>{var t=Math.floor(10*f.volume)/10;"+"===e?t<1&&(f.volume=(f.volume+.1).toFixed(1),p.value=Number(p.value)+.1):"-"===e&&0<t&&(f.volume=(f.volume-.1).toFixed(1),p.value=Number(p.value)-.1)};p.addEventListener("input",()=>{f.volume=p.value}),p.addEventListener("change",()=>{0==p.value?o.setAttribute("disabled","disabled"):o.removeAttribute("disabled")}),o.addEventListener("click",()=>{f.muted=!f.muted;var e=f.volume;f.muted?(p.value=0,p.setAttribute("disabled","disabled")):(p.value=e,p.removeAttribute("disabled"))}),g.querySelector(".v-controls__sound-up").addEventListener("click",()=>{q("+")}),g.querySelector(".v-controls__sound-down").addEventListener("click",()=>{q("-")});const r=g.querySelector(".v-controls__fullscreen"),s=!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitSupportsFullscreen||document.webkitFullscreenEnabled||document.createElement("video").webkitRequestFullScreen);s||(r.style.display="none");const t=t=>{e.setAttribute("data-fullscreen",!!t)},u=function(){return!!(document.fullScreen||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)},v=function(){u()?(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen(),t(!1)):(e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen?f.webkitRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen(),t(!0))};r.addEventListener("click",()=>{v()}),document.addEventListener("fullscreenchange",()=>{t(!(!document.fullScreen&&!document.fullscreenElement))}),document.addEventListener("webkitfullscreenchange",()=>{t(!!document.webkitIsFullScreen)}),document.addEventListener("mozfullscreenchange",()=>{t(!!document.mozFullScreen)}),document.addEventListener("msfullscreenchange",()=>{t(!!document.msFullscreenElement)})}const commonModalOpen=()=>{document.body.classList.add("overlay"),document.addEventListener("keydown",onEscKeyDown),document.querySelector(".overlay").addEventListener("click",onOverlayClick),floatingBasketButton.style.display="none",anchor.classList.remove("anchor-show")},commonModalClose=()=>{document.body.classList.remove("overlay"),document.removeEventListener("keydown",onEscKeyDown),document.body.removeEventListener("click",onOverlayClick),floatingBasketButton.style.display="block",anchor.classList.add("anchor-show")},allModalClose=()=>{document.querySelectorAll(".modal").forEach(e=>{e.classList.contains("is-opened")&&(e.classList.remove("is-opened"),commonModalClose())})},onEscKeyDown=e=>{"Escape"!==e.key&&"Esc"!==e.key||allModalClose()},onOverlayClick=e=>{"overlay"===e.target.className&&allModalClose()},onCloseButtonClick=e=>{e.preventDefault(),e.target.parentNode.parentNode.classList.remove("is-opened"),commonModalClose()},askQuestionButton=document.querySelector(".promo__button"),modalConsultation=document.querySelector(".modal-consultation"),modalConsultationCloseButton=modalConsultation.querySelector(".modal-consultation__close"),modalConsultationTraps=modalConsultation.querySelectorAll(".focus-trap"),modalConsultationOpen=()=>{commonModalOpen(),modalConsultation.classList.add("is-opened"),modalConsultation.querySelector("textarea").focus()};askQuestionButton.addEventListener("click",e=>{e.preventDefault(),modalConsultationOpen()}),modalConsultationCloseButton.addEventListener("click",e=>{onCloseButtonClick(e)}),modalConsultationTraps.forEach(e=>e.addEventListener("focus",()=>{(e.classList.contains("focus-trap--upper")?modalConsultation.querySelector(".modal-consultation__close"):modalConsultation.querySelector("textarea")).focus()}));const feedbackSendButton=document.querySelector(".feedback__button"),modalFeedback=document.querySelector(".modal-feedback"),feedbackAgree=document.querySelector(".feedback__checkbox"),feedbackForm=document.querySelector(".feedback form"),feedbackPhone=document.getElementById("your-phone"),modalFeedbackOpen=()=>{commonModalOpen(),modalFeedback.classList.add("is-opened")},modalFeedbackClose=()=>{commonModalClose(),modalFeedback.classList.remove("is-opened")};feedbackForm.addEventListener("submit",e=>{e.preventDefault(),modalFeedbackOpen(),feedbackForm.reset(),setTimeout(modalFeedbackClose,3e3)}),feedbackAgree.addEventListener("invalid",function(){this.setCustomValidity("К сожалению, нам нужно, чтобы вы подтвердили свое согласие, как того требует текущее законодательство")}),feedbackAgree.addEventListener("change",function(){this.setCustomValidity("")}),feedbackPhone.addEventListener("input",()=>{feedbackPhone.validity.patternMismatch?feedbackPhone.setCustomValidity("Пока что это не похоже на телефон =)"):feedbackPhone.setCustomValidity("")});const callBackButton=document.querySelector(".main-header__call-back"),modalCallOrder=document.querySelector(".modal-call-order"),closeModalCallOrderButton=modalCallOrder.querySelector(".modal-call-order__cancel-button"),submitModalCallOrderButton=modalCallOrder.querySelector(".modal-call-order__submit-button"),modalCallOrderTraps=modalCallOrder.querySelectorAll(".focus-trap"),orderPhoneInput=modalCallOrder.querySelector(".modal-call-order__phone-input"),modalCallOrderOpen=()=>{commonModalOpen(),modalCallOrder.classList.add("is-opened"),modalCallOrder.querySelector("input").focus()};callBackButton.addEventListener("click",e=>{e.preventDefault(),modalCallOrderOpen()}),closeModalCallOrderButton.addEventListener("click",e=>{onCloseButtonClick(e),modalCallOrder.classList.remove("is-opened")}),modalCallOrderTraps.forEach(e=>e.addEventListener("focus",()=>{(e.classList.contains("focus-trap--upper")?modalCallOrder.querySelector(".modal-call-order__submit-button"):modalCallOrder.querySelector("input")).focus()})),modalCallOrder.querySelector("form").addEventListener("submit",e=>{e.preventDefault(),submitModalCallOrderButton.setAttribute("disabled","true"),modalCallOrder.querySelector("p").textContent="Спасибо! В ближайшее время мы вам перезвоним",setTimeout(()=>{submitModalCallOrderButton.removeAttribute("disabled"),onCloseButtonClick(e),modalCallOrder.classList.remove("is-opened"),modalCallOrder.querySelector("p").textContent="Оставьте ваш телефон и мы обязательно свяжемся с вами",modalCallOrder.querySelector("form").reset()},3e3)}),orderPhoneInput.addEventListener("input",()=>{orderPhoneInput.validity.patternMismatch?orderPhoneInput.setCustomValidity("Пока что это не похоже на телефон =)"):orderPhoneInput.setCustomValidity("")});const openCartButton=document.querySelector(".main-header__shopping-cart"),modalShoppingCart=document.querySelector(".modal-shopping-cart"),closeCartButton=modalShoppingCart.querySelector(".modal-shopping-cart__close-button"),modalShoppingCartTraps=modalShoppingCart.querySelectorAll(".focus-trap"),cartCont=modalShoppingCart.querySelector(".modal-shopping-cart__basket"),clearCartButton=modalShoppingCart.querySelector(".modal-shopping-cart__clear-button");let countOfProducts=document.querySelector(".aerostat span");const cards=document.querySelectorAll(".production__card-item"),setCartData=e=>localStorage.setItem("cart",JSON.stringify(e)),getCartData=()=>JSON.parse(localStorage.getItem("cart")),calculateProducts=e=>{let t=0;for(const o in e)t+=e[o].count;return t},openCart=()=>{const l=getCartData(),a=e=>{let t="",o=0;t+='<table class="shopping-list"><tr><th>Наименование</th><th>Цена</th><th>Кол-во</th></tr>';for(const r in e)o+=Number(e[r].price.replace(/\D+/g,""))*e[r].count,t+=`<tr><td>${e[r].title}</td><td>${e[r].price}</td><td>${e[r].count}</td><td><button class="product-add" title="Добавить товар" data-id=${r}>+</button></td><td><button class="product-remove" title="Удалить товар" data-id=${r}>х</button></td><td><button class="product-subtract" title="Убавить товар" data-id=${r}>-</button></td></tr>`;t+=`</table><p>Итого: ${o} ₽</p>`,cartCont.innerHTML=t;const n=function(){switch(this.className){case"product-add":l[this.getAttribute("data-id")].count++;break;case"product-subtract":l[this.getAttribute("data-id")].count--,l[this.getAttribute("data-id")].count<1&&delete l[this.getAttribute("data-id")];break;case"product-remove":delete l[this.getAttribute("data-id")]}setCartData(l),a(getCartData()),countOfProducts.textContent=calculateProducts(getCartData())};cartCont.querySelectorAll("[data-id]").forEach(e=>e.addEventListener("click",n))};null!==l?a(l):cartCont.innerHTML="В корзине пусто"},addToCart=function(){const e=getCartData()||{},t=this.parentNode.parentNode;var o=this.getAttribute("data-id"),n=t.querySelector(".production__card-heading").innerHTML,r=t.querySelector(".production__card-price").innerHTML;e.hasOwnProperty(o)?e[o].count++:e[o]={title:n,price:r,count:1},setCartData(e),countOfProducts.textContent=calculateProducts(getCartData())},onEnterKeyDown=e=>{"Enter"===e.key&&addToCart()},shoppingCartOpen=()=>{commonModalOpen(),modalShoppingCart.classList.add("is-opened"),modalShoppingCart.querySelector(".modal-shopping-cart__close-button").focus(),openCart()};document.addEventListener("DOMContentLoaded",()=>{countOfProducts.textContent=calculateProducts(getCartData())}),cards.forEach(e=>e.querySelector(".production__card-button").addEventListener("click",addToCart)),cards.forEach(e=>e.querySelector(".production__card-button").addEventListener("keydown",onEnterKeyDown)),openCartButton.addEventListener("click",e=>{e.preventDefault(),shoppingCartOpen()}),floatingBasketButton.addEventListener("click",e=>{e.preventDefault(),shoppingCartOpen()}),closeCartButton.addEventListener("click",e=>{onCloseButtonClick(e),countOfProducts.textContent=calculateProducts(getCartData())}),clearCartButton.addEventListener("click",()=>{localStorage.removeItem("cart"),countOfProducts.textContent=calculateProducts(getCartData()),cartCont.innerHTML="Корзина очишена"}),modalShoppingCartTraps.forEach(e=>e.addEventListener("focus",()=>{(e.classList.contains("focus-trap--upper")?modalShoppingCart.querySelector(".modal-shopping-cart__clear-button"):modalShoppingCart.querySelector(".modal-shopping-cart__close-button")).focus()}));